#!/usr/bin/env bash

# This file is part of the Zephir.
#
# (c) Phalcon Team <team@zephir-lang.com>
#
# For the full copyright and license information, please view
# the LICENSE file that was distributed with this source code.

# THIS FILE IS AUTOMATICALLY GENERATED BY CMAKE
# DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN

# set sharness verbosity. we set the env var directly as
# it's too late to pass in --verbose, and --verbose is harder
# to pass through in some cases.
# shellcheck disable=SC2034
test "$TEST_VERBOSE" = 1 && verbose=t

PROJECTDIR="@zephir_SOURCE_DIR@"
TESTSDIR="@CMAKE_CURRENT_SOURCE_DIR@"
SHARNESS_TEST_SRCDIR="$TESTSDIR/sharness"
SHARNESS_LIB="$SHARNESS_TEST_SRCDIR/sharness.sh"
export PROJECTDIR TESTSDIR SHARNESS_TEST_SRCDIR SHARNESS_LIB

# shellcheck source=lib/sharness/sharness.sh
source "$SHARNESS_LIB" || {
  echo >&2 "Cannot source: $SHARNESS_LIB"
  echo >&2 "Please check Sharness installation."
  exit 1
}

if test "$TEST_VERBOSE" = 1; then
  (>&1 printf "# TEST_VERBOSE='%s'\n" "$TEST_VERBOSE")
fi

FIXTURESDIR="$TESTSDIR/fixtures"
OUTPUTDIR="$TESTSDIR/output"
export FIXTURESDIR OUTPUTDIR

function zephirc() {
  command="@ZEPHIR_EXE_DIR@/@ZEPHIR_APP_TARGET@ $*"

  test "$TEST_VERBOSE" = 1 && (>&1 printf "# %s\\n" "$command")
  eval "$command"
}
